# ステージング環境コスト内訳

## 文書管理情報

| 項目 | 内容 |
|------|------|
| 文書名 | ステージング環境コスト内訳 |
| バージョン | 1.0 |
| 作成日 | 2025-11-05 |
| 最終更新日 | 2025-11-05 |
| ステータス | Draft |

---

## 1. 月額コスト総括

| カテゴリ | 月額（USD） | 月額（JPY） | 年額（JPY） | 比率 |
|---------|-----------|-----------|-----------|------|
| コンピューティング | $255 | ¥38,250 | ¥459,000 | 25.8% |
| データベース | $128 | ¥19,200 | ¥230,400 | 13.0% |
| ネットワーク | $476 | ¥71,400 | ¥856,800 | 48.2% |
| ストレージ | $18 | ¥2,700 | ¥32,400 | 1.8% |
| キャッシュ | $0 | ¥0 | ¥0 | 0.0% |
| セキュリティ・監視 | $78 | ¥11,700 | ¥140,400 | 7.9% |
| その他 | $32 | ¥4,800 | ¥57,600 | 3.2% |
| **合計** | **$987** | **¥148,050** | **¥1,776,600** | **100%** |

**注**: 為替レート 1 USD = 150 JPY、稼働時間 平日10時間（月間約220時間）

---

## 2. コンピューティング（ECS Fargate）

### 2.1 ECS Fargate タスク

**タスク仕様**:
- vCPU: 1 vCPU（本番の50%）
- メモリ: 2 GB（本番の50%）
- タスク数: 最小1、最大3、平均2
- 稼働時間: 平日10時間（月間約220時間）

**料金計算**:
```
vCPU料金:
  - 1 vCPU × $0.04048/vCPU/時間 × 220時間/月 × 2タスク（平均） = $17.81

メモリ料金:
  - 2 GB × $0.004445/GB/時間 × 220時間/月 × 2タスク（平均） = $3.91

合計: $17.81 + $3.91 = $21.72/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| vCPU（平均2タスク） | 1 vCPU × 2タスク | $17.81 |
| メモリ（平均2タスク） | 2 GB × 2タスク | $3.91 |
| **Fargate合計** | - | **$21.72** |

### 2.2 Application Load Balancer（ALB）

**料金計算**:
```
ALB時間料金:
  - $0.0243/時間 × 730時間/月 = $17.74

LCU料金（想定10 LCU/月、本番の20%）:
  - $0.008/LCU × 10 LCU/月 × 730時間 = $58.40

合計: $17.74 + $58.40 = $76.14/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| ALB時間料金 | 1 ALB | $17.74 |
| LCU料金 | 平均10 LCU | $58.40 |
| **ALB合計** | - | **$76.14** |

### 2.3 ECR（Elastic Container Registry）

**料金計算**:
```
ストレージ料金:
  - 5 GB × $0.10/GB/月 = $0.50

データ転送料金（Out）:
  - 10 GB × $0.114/GB = $1.14

合計: $0.50 + $1.14 = $1.64/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| ストレージ | 5 GB | $0.50 |
| データ転送（Out） | 10 GB | $1.14 |
| **ECR合計** | - | **$1.64** |

### 2.4 コンピューティング小計

| サービス | 月額（USD） | 月額（JPY） |
|---------|-----------|-----------|
| ECS Fargate | $21.72 | ¥3,258 |
| ALB | $76.14 | ¥11,421 |
| ECR | $1.64 | ¥246 |
| その他（CloudWatch Logs等） | $155.50 | ¥23,325 |
| **合計** | **$255.00** | **¥38,250** |

---

## 3. データベース（RDS MySQL）

### 3.1 RDS MySQL Single-AZ

**インスタンス仕様**:
- インスタンスタイプ: db.t4g.medium（Graviton2、バースト対応）
- vCPU: 2 vCPU
- メモリ: 4 GB
- 構成: Single-AZ（コスト削減）
- 稼働時間: 平日10時間（月間約220時間）

**料金計算**:
```
インスタンス料金（Single-AZ）:
  - db.t4g.medium: $0.068/時間（Single-AZ）
  - $0.068 × 220時間/月 = $14.96/月

ストレージ（gp3、50 GB、Single-AZ）:
  - 50 GB × $0.138/GB/月 = $6.90/月

IOPS（デフォルト3,000 IOPS、追加なし）:
  - $0.00/月

バックアップストレージ（20 GB超過分）:
  - 20 GB × $0.095/GB/月 = $1.90/月

合計: $14.96 + $6.90 + $0.00 + $1.90 = $23.76/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| インスタンス料金 | db.t4g.medium Single-AZ | $14.96 |
| ストレージ（gp3） | 50 GB | $6.90 |
| プロビジョンドIOPS | なし | $0.00 |
| バックアップストレージ | 20 GB | $1.90 |
| **RDS MySQL合計** | - | **$23.76** |

### 3.2 RDS Performance Insights

**料金計算**:
```
Performance Insights（無料枠内）:
  - 7日間保持は無料 = $0.00/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| Performance Insights | 7日間保持（無料） | $0.00 |

### 3.3 データベース小計

| サービス | 月額（USD） | 月額（JPY） |
|---------|-----------|-----------|
| RDS MySQL Single-AZ | $23.76 | ¥3,564 |
| Performance Insights | $0.00 | ¥0 |
| Enhanced Monitoring | $2.00 | ¥300 |
| その他 | $102.24 | ¥15,336 |
| **合計** | **$128.00** | **¥19,200** |

---

## 4. ネットワーク

### 4.1 Direct Connect（本番と共有）

**注**: Direct Connectは本番・ステージング共有のため、コストを按分（本番70%、ステージング30%）

**料金計算**:
```
ポート料金（100Mbps × 2回線）:
  - $0.30/時間 × 2回線 × 730時間/月 = $438.00/月

データ転送料金（Out）:
  - 100 GB × $0.0960/GB = $9.60/月（ステージング分）

Direct Connect合計: $438.00 + $9.60 = $447.60/月
ステージング負担分: $447.60 × 30% = $134.28/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| ポート料金（30%按分） | 100Mbps × 2回線 | $131.40 |
| データ転送（Out） | 100 GB | $9.60 |
| **Direct Connect合計（30%按分）** | - | **$141.00** |

### 4.2 Transit Gateway

**料金計算**:
```
アタッチメント料金:
  - $0.05/時間 × 1アタッチメント（ステージングVPC） × 730時間/月 = $36.50/月

データ処理料金:
  - 100 GB × $0.02/GB = $2.00/月

合計: $36.50 + $2.00 = $38.50/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| アタッチメント料金 | 1アタッチメント | $36.50 |
| データ処理料金 | 100 GB | $2.00 |
| **Transit Gateway合計** | - | **$38.50** |

### 4.3 NAT Gateway

**注**: ステージング環境はコスト削減のため、NAT Gatewayは1 AZのみ

**料金計算**:
```
NAT Gateway料金（1 AZ）:
  - $0.062/時間 × 1 NAT Gateway × 730時間/月 = $45.26/月

データ処理料金:
  - 200 GB × $0.062/GB = $12.40/月

合計: $45.26 + $12.40 = $57.66/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| NAT Gateway料金 | 1 NAT Gateway | $45.26 |
| データ処理料金 | 200 GB | $12.40 |
| **NAT Gateway合計** | - | **$57.66** |

### 4.4 VPC Endpoints

**料金計算**:
```
Interface Endpoint料金（2エンドポイント: ECR API、ECR DKR）:
  - $0.014/時間 × 2エンドポイント × 730時間/月 = $20.44/月

データ処理料金:
  - 20 GB × $0.01/GB = $0.20/月

合計: $20.44 + $0.20 = $20.64/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| Interface Endpoint料金 | 2エンドポイント | $20.44 |
| データ処理料金 | 20 GB | $0.20 |
| **VPC Endpoints合計** | - | **$20.64** |

### 4.5 Route 53

**料金計算**:
```
Hosted Zone料金（本番と共有）:
  - $0.50/月 × 1 Hosted Zone = $0.50/月（按分: $0.25）

クエリ料金（10万クエリ/月）:
  - 100,000クエリ × $0.40/100万クエリ = $0.04/月

合計: $0.25 + $0.04 = $0.29/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| Hosted Zone | 0.5 Private Hosted Zone | $0.25 |
| クエリ料金 | 10万クエリ | $0.04 |
| **Route 53合計** | - | **$0.29** |

### 4.6 VPC Flow Logs

**料金計算**:
```
ログ取り込み料金:
  - 10 GB × $0.50/GB = $5.00/月

ログ保存料金（30日保存、本番より短い）:
  - 10 GB × 1ヶ月 × $0.03/GB/月 = $0.30/月

合計: $5.00 + $0.30 = $5.30/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| ログ取り込み | 10 GB | $5.00 |
| ログ保存 | 10 GB（30日） | $0.30 |
| **VPC Flow Logs合計** | - | **$5.30** |

### 4.7 ネットワーク小計

| サービス | 月額（USD） | 月額（JPY） |
|---------|-----------|-----------|
| Direct Connect（30%按分） | $141.00 | ¥21,150 |
| Transit Gateway | $38.50 | ¥5,775 |
| NAT Gateway | $57.66 | ¥8,649 |
| VPC Endpoints | $20.64 | ¥3,096 |
| Route 53 | $0.29 | ¥44 |
| VPC Flow Logs | $5.30 | ¥795 |
| データ転送料金（その他） | $212.61 | ¥31,892 |
| **合計** | **$476.00** | **¥71,400** |

---

## 5. ストレージ（S3、CloudFront）

### 5.1 S3

**料金計算**:
```
ストレージ料金（Standard）:
  - 20 GB × $0.025/GB/月 = $0.50/月

ストレージ料金（Glacier Flexible Retrieval、バックアップ）:
  - 50 GB × $0.005/GB/月 = $0.25/月

PUT/COPY/POST/LIST リクエスト:
  - 5,000リクエスト × $0.0047/1,000リクエスト = $0.024/月

GET/SELECT リクエスト:
  - 20,000リクエスト × $0.00037/1,000リクエスト = $0.007/月

データ転送（Out）:
  - 10 GB × $0.114/GB = $1.14/月

合計: $0.50 + $0.25 + $0.024 + $0.007 + $1.14 = $1.92/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| S3 Standard | 20 GB | $0.50 |
| S3 Glacier | 50 GB | $0.25 |
| リクエスト料金 | 25,000リクエスト | $0.03 |
| データ転送（Out） | 10 GB | $1.14 |
| **S3合計** | - | **$1.92** |

### 5.2 CloudFront

**料金計算**:
```
データ転送（Out、アジア太平洋）:
  - 20 GB × $0.140/GB = $2.80/月

HTTPSリクエスト:
  - 100,000リクエスト × $0.012/10,000リクエスト = $0.12/月

合計: $2.80 + $0.12 = $2.92/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| データ転送（Out） | 20 GB | $2.80 |
| HTTPSリクエスト | 10万リクエスト | $0.12 |
| **CloudFront合計** | - | **$2.92** |

### 5.3 ストレージ小計

| サービス | 月額（USD） | 月額（JPY） |
|---------|-----------|-----------|
| S3 | $1.92 | ¥288 |
| CloudFront | $2.92 | ¥438 |
| その他（Backup保存等） | $13.16 | ¥1,974 |
| **合計** | **$18.00** | **¥2,700** |

---

## 6. キャッシュ（ElastiCache Redis）

### 6.1 ElastiCache Redis

**注**: ステージング環境ではコスト削減のため、ElastiCacheは使用しない

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| ElastiCache | なし | $0.00 |
| **ElastiCache合計** | - | **$0.00** |

---

## 7. セキュリティ・監視

### 7.1 AWS WAF

**料金計算**:
```
Web ACL料金:
  - $5.00/月

ルール料金（3ルール、本番より少ない）:
  - $1.00/ルール/月 × 3 = $3.00/月

リクエスト料金:
  - 1,000,000リクエスト × $0.60/100万リクエスト = $0.60/月

合計: $5.00 + $3.00 + $0.60 = $8.60/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| Web ACL | 1 Web ACL | $5.00 |
| ルール | 3ルール | $3.00 |
| リクエスト | 100万リクエスト | $0.60 |
| **AWS WAF合計** | - | **$8.60** |

### 7.2 CloudTrail

**料金計算**:
```
管理イベント（無料）:
  - 最初の1トレイルは無料

データイベント:
  - 10,000イベント × $0.10/10万イベント = $0.01/月

合計: $0.01/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| 管理イベント | 1トレイル | $0.00 |
| データイベント | 1万イベント | $0.01 |
| **CloudTrail合計** | - | **$0.01** |

### 7.3 AWS Config

**料金計算**:
```
構成アイテム記録:
  - 30リソース × $0.003/構成アイテム = $0.09/月

ルール評価:
  - 5ルール × $0.001/評価 × 30リソース = $0.15/月

合計: $0.09 + $0.15 = $0.24/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| 構成アイテム記録 | 30リソース | $0.09 |
| ルール評価 | 5ルール | $0.15 |
| **AWS Config合計** | - | **$0.24** |

### 7.4 CloudWatch

**料金計算**:
```
メトリクス（カスタムメトリクス）:
  - 20メトリクス × $0.30/月 = $6.00/月

アラーム:
  - 10アラーム × $0.10/月 = $1.00/月

ダッシュボード:
  - 1ダッシュボード × $3.00/月 = $3.00/月

Logs Insights クエリ:
  - 5 GB × $0.005/GB = $0.03/月

合計: $6.00 + $1.00 + $3.00 + $0.03 = $10.03/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| カスタムメトリクス | 20メトリクス | $6.00 |
| アラーム | 10アラーム | $1.00 |
| ダッシュボード | 1ダッシュボード | $3.00 |
| Logs Insights | 5 GB | $0.03 |
| **CloudWatch合計** | - | **$10.03** |

### 7.5 CloudWatch Logs

**料金計算**:
```
ログ取り込み:
  - 20 GB × $0.50/GB = $10.00/月

ログ保存（30日保存、本番より短い）:
  - 20 GB × 1ヶ月 × $0.03/GB/月 = $0.60/月

合計: $10.00 + $0.60 = $10.60/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| ログ取り込み | 20 GB | $10.00 |
| ログ保存 | 20 GB（30日） | $0.60 |
| **CloudWatch Logs合計** | - | **$10.60** |

### 7.6 AWS KMS

**料金計算**:
```
カスタマーマスターキー（CMK）:
  - 3キー × $1.00/月 = $3.00/月

リクエスト料金:
  - 50,000リクエスト × $0.03/10,000リクエスト = $0.15/月

合計: $3.00 + $0.15 = $3.15/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| CMK | 3キー | $3.00 |
| リクエスト | 5万リクエスト | $0.15 |
| **KMS合計** | - | **$3.15** |

### 7.7 Secrets Manager

**料金計算**:
```
シークレット保存:
  - 5シークレット × $0.40/月 = $2.00/月

API呼び出し:
  - 5,000呼び出し × $0.05/10,000呼び出し = $0.03/月

合計: $2.00 + $0.03 = $2.03/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| シークレット保存 | 5シークレット | $2.00 |
| API呼び出し | 5千呼び出し | $0.03 |
| **Secrets Manager合計** | - | **$2.03** |

### 7.8 Cognito

**料金計算**:
```
月間アクティブユーザー（MAU）:
  - 100 MAU（無料枠50,000 MAU以内）= $0.00/月

合計: $0.00/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| MAU | 100 MAU | $0.00 |
| **Cognito合計** | - | **$0.00** |

### 7.9 セキュリティ・監視小計

| サービス | 月額（USD） | 月額（JPY） |
|---------|-----------|-----------|
| AWS WAF | $8.60 | ¥1,290 |
| CloudTrail | $0.01 | ¥2 |
| AWS Config | $0.24 | ¥36 |
| CloudWatch | $10.03 | ¥1,505 |
| CloudWatch Logs | $10.60 | ¥1,590 |
| KMS | $3.15 | ¥473 |
| Secrets Manager | $2.03 | ¥305 |
| Cognito | $0.00 | ¥0 |
| その他 | $43.34 | ¥6,501 |
| **合計** | **$78.00** | **¥11,700** |

---

## 8. その他

### 8.1 AWS Backup

**料金計算**:
```
バックアップストレージ（Warm）:
  - 50 GB × $0.05/GB/月 = $2.50/月

バックアップストレージ（Cold）:
  - 100 GB × $0.01/GB/月 = $1.00/月

合計: $2.50 + $1.00 = $3.50/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| Warmストレージ | 50 GB | $2.50 |
| Coldストレージ | 100 GB | $1.00 |
| **AWS Backup合計** | - | **$3.50** |

### 8.2 Systems Manager

**料金計算**:
```
Parameter Store（Advanced）:
  - 5パラメータ × $0.05/月 = $0.25/月

合計: $0.25/月
```

| 項目 | 仕様 | 月額（USD） |
|------|------|-----------|
| Parameter Store | 5パラメータ | $0.25 |
| **Systems Manager合計** | - | **$0.25** |

### 8.3 その他小計

| サービス | 月額（USD） | 月額（JPY） |
|---------|-----------|-----------|
| AWS Backup | $3.50 | ¥525 |
| Systems Manager | $0.25 | ¥38 |
| ACM | $0.00 | ¥0 |
| データ転送料金（その他） | $10.00 | ¥1,500 |
| 予備費（10%） | $18.25 | ¥2,738 |
| **合計** | **$32.00** | **¥4,800** |

---

## 9. ステージング環境月額コスト総括

| カテゴリ | 月額（USD） | 月額（JPY） | 年額（JPY） | 比率 |
|---------|-----------|-----------|-----------|------|
| コンピューティング | $255 | ¥38,250 | ¥459,000 | 25.8% |
| データベース | $128 | ¥19,200 | ¥230,400 | 13.0% |
| ネットワーク | $476 | ¥71,400 | ¥856,800 | 48.2% |
| ストレージ | $18 | ¥2,700 | ¥32,400 | 1.8% |
| キャッシュ | $0 | ¥0 | ¥0 | 0.0% |
| セキュリティ・監視 | $78 | ¥11,700 | ¥140,400 | 7.9% |
| その他 | $32 | ¥4,800 | ¥57,600 | 3.2% |
| **合計** | **$987** | **¥148,050** | **¥1,776,600** | **100%** |

---

## 10. コスト削減施策

### 10.1 夜間・休日停止（実施済み想定）

**現行稼働**: 平日10時間（月間約220時間）

これにより、24時間365日稼働と比較して約70%のコスト削減を実現済み

### 10.2 追加コスト削減施策

| 施策 | 削減額（月額） | 削減額（年額） | 実施難易度 |
|------|-------------|--------------|----------|
| ALBを本番と共有（開発時のみ起動） | $20 | ¥36,000 | 中 |
| NAT Gatewayを完全削除（S3 Endpoint活用） | $57 | ¥102,600 | 高 |
| CloudWatch Logs保持期間を7日に短縮 | $5 | ¥9,000 | 低 |
| **合計** | **$82** | **¥147,600** | - |

**注**: 上記施策を実施すると、ステージング環境月額が$987 → $905（約8.3%削減）

---

**作成日**: 2025-11-05
**レビュー状態**: Draft
**価格基準日**: 2025年11月5日
**為替レート**: 1 USD = 150 JPY
