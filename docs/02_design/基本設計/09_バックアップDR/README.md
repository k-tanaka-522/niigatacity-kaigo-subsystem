# 09. バックアップ・DR設計

## 概要

新潟市介護保険サブシステムのバックアップ・災害復旧設計ドキュメントです。

## ドキュメント構成

| ドキュメント | 概要 | ページ数 |
|------------|------|---------|
| [backup_dr_design.md](./backup_dr_design.md) | バックアップ・DR設計全体 | 18ページ |
| [backup_flow.md](./backup_flow.md) | バックアップフロー詳細 | 10ページ |
| [dr_procedure.md](./dr_procedure.md) | DR手順書 | 15ページ |

## 主要な設計判断

### バックアップ・DR要件

| 項目 | 要件 |
|------|------|
| RPO (Recovery Point Objective) | 1時間 |
| RTO (Recovery Time Objective) | 4時間 |
| バックアップ保持期間 | 30日 (本番)、7日 (ステージング) |
| DR環境 | us-west-2 |

### バックアップ戦略

#### RDS

- 自動バックアップ: 日次 (03:00 JST)
- ポイントインタイムリカバリ (PITR): 7日保持
- クロスリージョンコピー: us-west-2

#### EFS

- AWS Backup: 日次 (04:00 JST)
- 保持期間: 30日
- クロスリージョンコピー: us-west-2

#### S3

- バージョニング: 有効
- クロスリージョンレプリケーション: リアルタイム (us-west-2)

### DR戦略

- **DR環境**: us-west-2
- **事前構築**: VPC、サブネット、セキュリティグループ、ALB (停止状態)、ECS クラスター (0タスク)
- **DR発動時**: RDS復元、ElastiCache作成、EFS復元、ECS起動
- **DNS切り替え**: Route 53 (TTL 60秒)

## DR発動基準

| シナリオ | 発動基準 |
|---------|---------|
| リージョン全停止 | 4時間以上の復旧見込み |
| 複数AZ障害 | 2時間以上の復旧見込み |
| サイバー攻撃 | データ復旧が必要 |

## DR訓練計画

| 訓練種別 | 頻度 |
|---------|------|
| 机上訓練 | 四半期ごと |
| 部分訓練 | 半年ごと |
| フルスケール訓練 | 年1回 |

## コスト

### バックアップコスト (月額)

- 本番環境: $96
- ステージング環境: $20

### DR環境コスト

- 常時稼働: $2/月
- DR発動時: $43/日

## 関連ドキュメント

- [データベース設計](../05_database/rds_design.md)
- [監視設計](../08_monitoring/monitoring_design.md)
- [セキュリティ設計](../07_security/security_design.md)

---

**作成日**: 2025-11-05
**作成者**: Architect
