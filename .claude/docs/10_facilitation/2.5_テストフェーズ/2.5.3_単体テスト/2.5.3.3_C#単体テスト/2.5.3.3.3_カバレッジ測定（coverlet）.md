# 2.5.3.3.3 ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šï¼ˆcoverletï¼‰

## ç›®çš„

ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’æ¸¬å®šã—ã€80%ä»¥ä¸Šã‚’é”æˆã—ã¾ã™ã€‚

---

## ğŸ“Š ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š

### coverletã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# coverlet.msbuildã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
dotnet add package coverlet.msbuild

# ã¾ãŸã¯ coverlet.collectorã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
dotnet add package coverlet.collector
```

### å®Ÿè¡Œ

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
dotnet test /p:CollectCoverage=true

# HTMLå½¢å¼ã§ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
dotnet test /p:CollectCoverage=true /p:CoverletOutputFormat=opencover

# reportgeneratorã§HTMLãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
dotnet tool install -g dotnet-reportgenerator-globaltool
reportgenerator -reports:coverage.opencover.xml -targetdir:coverage-report
```

### ã‚«ãƒãƒ¬ãƒƒã‚¸è¨­å®šï¼ˆ.csprojï¼‰

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <IsPackable>false</IsPackable>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="coverlet.msbuild" Version="6.0.0">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
  </ItemGroup>

  <PropertyGroup>
    <CollectCoverage>true</CollectCoverage>
    <CoverletOutputFormat>opencover</CoverletOutputFormat>
    <Threshold>80</Threshold>
    <ThresholdType>line,branch,method</ThresholdType>
    <Exclude>[MyApp.Tests]*,[*]*.Migrations.*</Exclude>
  </PropertyGroup>
</Project>
```

### coverlet.runsettings

```xml
<?xml version="1.0" encoding="utf-8" ?>
<RunSettings>
  <DataCollectionRunSettings>
    <DataCollectors>
      <DataCollector friendlyName="XPlat Code Coverage">
        <Configuration>
          <Format>opencover</Format>
          <Exclude>[MyApp.Tests]*,[*]*.Migrations.*</Exclude>
          <ExcludeByAttribute>Obsolete,GeneratedCode,CompilerGenerated</ExcludeByAttribute>
        </Configuration>
      </DataCollector>
    </DataCollectors>
  </DataCollectionRunSettings>
</RunSettings>
```

### CIã§ã®å®Ÿè¡Œ

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸é–¾å€¤ãƒã‚§ãƒƒã‚¯ä»˜ã
dotnet test /p:CollectCoverage=true /p:Threshold=80 /p:ThresholdType=line
```

### ç›®æ¨™

- âœ… **ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š**
- âœ… é‡è¦ãªæ¥­å‹™ãƒ­ã‚¸ãƒƒã‚¯: 90%ä»¥ä¸Š
- âœ… Lineã€Branchã€Methodã™ã¹ã¦ã§é”æˆ

---

**ä½œæˆæ—¥**: 2025-10-19
**é‡è¦åº¦**: â­â­â­
