# 2.4.5.4.4 Goä¸¦åˆ—å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨

## ç›®çš„

Goã®goroutineã¨channelã‚’ä½¿ã£ãŸä¸¦åˆ—å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

---

## ğŸ”„ ä¸¦åˆ—å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. åŸºæœ¬çš„ãªgoroutine â­â­â­

```go
// âœ… Good Example
func ProcessUsers(ids []int) {
    var wg sync.WaitGroup

    for _, id := range ids {
        wg.Add(1)
        go func(userID int) {
            defer wg.Done()
            processUser(userID)
        }(id)  // âœ… idã‚’å¼•æ•°ã§æ¸¡ã™
    }

    wg.Wait()
}

// âŒ Bad Example
for _, id := range ids {
    go func() {
        processUser(id)  // âŒ ãƒ«ãƒ¼ãƒ—å¤‰æ•°ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£
    }()
}
```

---

### 2. channelã«ã‚ˆã‚‹é€šä¿¡ â­â­

```go
func FetchUsers(ids []int) []*User {
    results := make(chan *User, len(ids))

    for _, id := range ids {
        go func(userID int) {
            user, err := GetUser(userID)
            if err == nil {
                results <- user
            }
        }(id)
    }

    users := make([]*User, 0, len(ids))
    for i := 0; i < len(ids); i++ {
        users = append(users, <-results)
    }

    return users
}
```

---

### 3. context ã«ã‚ˆã‚‹ã‚­ãƒ£ãƒ³ã‚»ãƒ« â­â­â­

```go
import "context"

func ProcessWithTimeout(ctx context.Context, id int) error {
    ctx, cancel := context.WithTimeout(ctx, 5*time.Second)
    defer cancel()

    done := make(chan error)

    go func() {
        done <- processUser(id)
    }()

    select {
    case err := <-done:
        return err
    case <-ctx.Done():
        return ctx.Err()  // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ or ã‚­ãƒ£ãƒ³ã‚»ãƒ«
    }
}
```

---

**ä½œæˆæ—¥**: 2025-10-19
**å¯¾è±¡ãƒ•ã‚§ãƒ¼ã‚º**: å®Ÿè£…
**é‡è¦åº¦**: â­â­â­ å¿…é ˆ
