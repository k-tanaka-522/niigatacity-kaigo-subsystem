# 2.4.5.2.2 TypeScriptãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆé©ç”¨

## ç›®çš„

`.claude/docs/40_standards/42_typescript.md` ã«æº–æ‹ ã—ãŸTypeScriptãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã‚’å®Ÿè£…ã—ã¾ã™ã€‚

---

## ğŸ“ æ¨™æº–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
myproject/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts          # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ app.ts            # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
â”‚   â”œâ”€â”€ api/              # APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ routes.ts
â”‚   â”‚   â”œâ”€â”€ middleware.ts
â”‚   â”‚   â””â”€â”€ validators.ts
â”‚   â”œâ”€â”€ models/           # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆå‹å®šç¾©ï¼‰
â”‚   â”‚   â”œâ”€â”€ user.ts
â”‚   â”‚   â””â”€â”€ product.ts
â”‚   â”œâ”€â”€ services/         # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ userService.ts
â”‚   â”‚   â””â”€â”€ productService.ts
â”‚   â”œâ”€â”€ repositories/     # ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ï¼ˆoptionalï¼‰
â”‚   â”‚   â””â”€â”€ userRepository.ts
â”‚   â””â”€â”€ utils/            # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚       â”œâ”€â”€ logger.ts
â”‚       â””â”€â”€ errors.ts
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ routes.test.ts
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ userService.test.ts
â”œâ”€â”€ dist/                 # ãƒ“ãƒ«ãƒ‰å‡ºåŠ›
â”œâ”€â”€ .env.example
â”œâ”€â”€ .eslintrc.json
â”œâ”€â”€ .prettierrc
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ jest.config.js
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

---

## âœ… å„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å½¹å‰²

### 1. `src/` - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰

**ç›®çš„**: ã™ã¹ã¦ã®TypeScriptã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã«é›†ç´„

**ãƒ«ãƒ¼ãƒ«**:
- âœ… å±¤åˆ¥è¨­è¨ˆã‚’å¾¹åº•ï¼ˆapi, models, services, repositories, utilsï¼‰
- âœ… ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯ `services/` ã«é…ç½®
- âœ… å‹å®šç¾©ã¯ `models/` ã«é…ç½®
- âœ… PascalCaseï¼ˆå‹ï¼‰ã€camelCaseï¼ˆå¤‰æ•°ãƒ»é–¢æ•°ï¼‰

---

### 2. `src/models/` - ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆå‹å®šç¾©ï¼‰

**ç›®çš„**: interfaceã‚„typeã‚’å®šç¾©

**ä¾‹**:

```typescript
// src/models/user.ts
export interface User {
  id: number;
  name: string;
  email: string;
  createdAt: Date;
}

export interface CreateUserDto {
  name: string;
  email: string;
}

export interface UpdateUserDto {
  name?: string;
  email?: string;
}
```

---

### 3. `src/services/` - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ â­é‡è¦

**ç›®çš„**: ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…

**åŸå‰‡**:
- âœ… APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã‚‹
- âœ… Repositoryã‚’ä½¿ç”¨
- âœ… ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“

**ä¾‹**:

```typescript
// src/services/userService.ts
import { User, CreateUserDto } from '../models/user';
import { UserRepository } from '../repositories/userRepository';
import { UserNotFoundError } from '../utils/errors';
import logger from '../utils/logger';

export class UserService {
  constructor(private userRepository: UserRepository) {}

  async getUser(userId: number): Promise<User> {
    const user = await this.userRepository.findById(userId);
    if (!user) {
      logger.warn(`User ${userId} not found`);
      throw new UserNotFoundError(`User ${userId} not found`);
    }
    return user;
  }

  async createUser(dto: CreateUserDto): Promise<User> {
    logger.info(`Creating user: ${dto.email}`);
    return await this.userRepository.create(dto);
  }
}
```

---

### 4. `src/api/` - APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

**ç›®çš„**: HTTP APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å®šç¾©

**ä¾‹**: Express

```typescript
// src/api/routes.ts
import { Router } from 'express';
import { UserService } from '../services/userService';
import { CreateUserDto } from '../models/user';
import { validateCreateUser } from './validators';

const router = Router();
const userService = new UserService(/* repository */);

router.get('/users/:id', async (req, res, next) => {
  try {
    const userId = parseInt(req.params.id);
    const user = await userService.getUser(userId);
    res.json(user);
  } catch (error) {
    next(error);
  }
});

router.post('/users', validateCreateUser, async (req, res, next) => {
  try {
    const dto: CreateUserDto = req.body;
    const user = await userService.createUser(dto);
    res.status(201).json(user);
  } catch (error) {
    next(error);
  }
});

export default router;
```

---

### 5. `tsconfig.json` - TypeScriptè¨­å®š â­â­â­å¿…é ˆ

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "moduleResolution": "node",
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "tests"]
}
```

**é‡è¦ãªè¨­å®š**:
- âœ… `strict: true` - å³æ ¼ãªå‹ãƒã‚§ãƒƒã‚¯
- âœ… `esModuleInterop: true` - CommonJSã¨ã®äº’æ›æ€§
- âœ… `skipLibCheck: true` - node_modules ã®å‹ãƒã‚§ãƒƒã‚¯ã‚¹ã‚­ãƒƒãƒ—

---

### 6. `.eslintrc.json` - ESLintè¨­å®š

```json
{
  "parser": "@typescript-eslint/parser",
  "extends": [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "prettier"
  ],
  "plugins": ["@typescript-eslint"],
  "env": {
    "node": true,
    "es2020": true
  },
  "rules": {
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/explicit-function-return-type": "warn"
  }
}
```

---

### 7. `package.json` - ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†

```json
{
  "name": "myproject",
  "version": "1.0.0",
  "scripts": {
    "build": "tsc",
    "start": "node dist/index.js",
    "dev": "ts-node-dev --respawn src/index.ts",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:cov": "jest --coverage",
    "lint": "eslint src/**/*.ts",
    "format": "prettier --write \"src/**/*.ts\""
  },
  "dependencies": {
    "express": "^4.18.0"
  },
  "devDependencies": {
    "@types/express": "^4.17.0",
    "@types/jest": "^29.5.0",
    "@types/node": "^20.0.0",
    "@typescript-eslint/eslint-plugin": "^6.0.0",
    "@typescript-eslint/parser": "^6.0.0",
    "eslint": "^8.0.0",
    "jest": "^29.5.0",
    "prettier": "^3.0.0",
    "ts-jest": "^29.1.0",
    "ts-node-dev": "^2.0.0",
    "typescript": "^5.0.0"
  }
}
```

---

## âŒ Bad Example: æ§‹æˆãŒä¸é©åˆ‡

```
myproject/
â”œâ”€â”€ index.ts          # âŒ ã™ã¹ã¦1ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ utils.ts
â””â”€â”€ test.ts
```

**å•é¡Œç‚¹**:
- å±¤åˆ¥è¨­è¨ˆãŒãªã„
- ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‚¥å¤§åŒ–
- ãƒ†ã‚¹ãƒˆãŒä¸ååˆ†

---

## âœ… Good Example: æŠ€è¡“æ¨™æº–ã«æº–æ‹ 

```
myproject/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/          # âœ… APIå±¤
â”‚   â”œâ”€â”€ models/       # âœ… å‹å®šç¾©
â”‚   â”œâ”€â”€ services/     # âœ… ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ repositories/ # âœ… ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤
â”‚   â””â”€â”€ utils/
â””â”€â”€ tests/
    â”œâ”€â”€ api/
    â””â”€â”€ services/     # âœ… å±¤ã”ã¨ã«ãƒ†ã‚¹ãƒˆ
```

**æ”¹å–„ç‚¹**:
- âœ… å±¤åˆ¥è¨­è¨ˆ
- âœ… è²¬å‹™ãŒæ˜ç¢º
- âœ… ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“

---

**ä½œæˆæ—¥**: 2025-10-19
**å¯¾è±¡ãƒ•ã‚§ãƒ¼ã‚º**: å®Ÿè£…
**é‡è¦åº¦**: â­â­â­ å¿…é ˆ
